<!DOCTYPE html>
<html>
<head>
    <title>Visible Camera + 3D Tracking</title>
    <style>
        body { 
            margin: 0;
            overflow: hidden;
            background: #000;
        }
        #hud {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #0f0;
            font-family: 'Courier New', monospace;
            z-index: 100;
        }
        #camera-preview {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 240px;
            border: 2px solid #0ff;
            z-index: 100;
        }
        canvas {
            position: fixed;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>
    <div id="hud">TRACKING ACTIVE</div>
    <video id="camera-preview"></video>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/holistic/holistic.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<script>
// 1. Setup Visible Camera Feed
const videoElement = document.getElementById('camera-preview');
videoElement.muted = true;

// 2. Initialize Tracking
const holistic = new Holistic({
    locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/holistic/${file}`
});

holistic.setOptions({
    modelComplexity: 2,
    refineFaceLandmarks: true
});

// 3. Start Camera
const camera = new Camera(videoElement, {
    onFrame: async () => {
        await holistic.send({image: videoElement});
    },
    width: 640,
    height: 480
});

camera.start().then(() => {
    videoElement.style.display = 'block';
}).catch(error => {
    document.getElementById('hud').innerHTML = `CAMERA ERROR: ${error.message}`;
});

// 4. Show Tracking Results
holistic.onResults(results => {
    document.getElementById('hud').innerHTML = `
        FACIAL POINTS: ${results.faceLandmarks?.length || 0}<br>
        BODY POINTS: ${results.poseLandmarks?.length || 0}<br>
        HANDS: ${results.handedness?.length || 0}
    `;
});

// 5. Make Camera Feed Visible
videoElement.addEventListener('loadeddata', () => {
    videoElement.play();
});
</script>
</body>
</html>
